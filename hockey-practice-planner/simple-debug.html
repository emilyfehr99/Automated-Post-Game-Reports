<!DOCTYPE html>
<html>
<head>
    <title>Simple Practice Plans Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .status { padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid; }
        .success { background: #d4edda; color: #155724; border-left-color: #28a745; }
        .error { background: #f8d7da; color: #721c24; border-left-color: #dc3545; }
        .warning { background: #fff3cd; color: #856404; border-left-color: #ffc107; }
        .info { background: #d1ecf1; color: #0c5460; border-left-color: #17a2b8; }
        button { padding: 12px 24px; margin: 8px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px; }
        button:hover { background: #0056b3; }
        .button-group { text-align: center; margin: 20px 0; }
        #details { margin-top: 20px; min-height: 200px; }
        .data-display { background: #f8f9fa; padding: 15px; border-radius: 6px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; max-height: 300px; overflow-y: auto; }
        h1 { color: #2c3e50; text-align: center; }
        .app-link { text-align: center; margin: 20px 0; }
        .app-link a { background: #28a745; color: white; padding: 15px 30px; text-decoration: none; border-radius: 8px; font-weight: bold; }
        .app-link a:hover { background: #218838; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Simple Practice Plans Debug</h1>
        
        <div class="app-link">
            <a href="https://hockey-practice-planner.vercel.app" target="_blank">üèí Open Main App</a>
        </div>
        
        <div class="button-group">
            <button onclick="checkLocalStorage()">üíæ Check Local Storage</button>
            <button onclick="clearCache()">üóëÔ∏è Clear Cache</button>
            <button onclick="showAllData()">üìä Show All Data</button>
            <button onclick="testAppConnection()">üåê Test App Connection</button>
        </div>
        
        <div id="details"></div>
    </div>

    <script>
        function addStatus(message, type = 'info') {
            const detailsDiv = document.getElementById('details');
            const timestamp = new Date().toLocaleTimeString();
            detailsDiv.innerHTML += `<div class="status ${type}"><strong>[${timestamp}]</strong> ${message}</div>`;
        }

        window.checkLocalStorage = function() {
            addStatus('üíæ Checking local storage...', 'info');
            
            try {
                const drills = localStorage.getItem('hockey-drills');
                const plans = localStorage.getItem('hockey-practice-plans');
                const settings = localStorage.getItem('hockey-settings');
                const deviceId = localStorage.getItem('hockey-device-id');
                
                addStatus(`üìä Local Storage Summary:`, 'info');
                addStatus(`‚Ä¢ Drills: ${drills ? JSON.parse(drills).length : 0} items`, drills ? 'success' : 'warning');
                addStatus(`‚Ä¢ Practice Plans: ${plans ? JSON.parse(plans).length : 0} items`, plans ? 'success' : 'error');
                addStatus(`‚Ä¢ Settings: ${settings ? 'Present' : 'Missing'}`, settings ? 'success' : 'warning');
                addStatus(`‚Ä¢ Device ID: ${deviceId || 'Missing'}`, deviceId ? 'success' : 'warning');
                
                if (plans) {
                    const plansData = JSON.parse(plans);
                    if (plansData.length > 0) {
                        addStatus(`üìã Practice Plans Found:`, 'success');
                        plansData.forEach((plan, index) => {
                            addStatus(`  ${index + 1}. "${plan.name}" (${plan.drills?.length || 0} drills, ${plan.totalDuration || 0} min)`, 'success');
                        });
                    } else {
                        addStatus('‚ö†Ô∏è Practice plans array is empty!', 'warning');
                    }
                } else {
                    addStatus('‚ùå NO PRACTICE PLANS IN LOCAL STORAGE!', 'error');
                }
                
                if (drills) {
                    const drillsData = JSON.parse(drills);
                    addStatus(`üèí Drills Found: ${drillsData.length}`, drillsData.length > 0 ? 'success' : 'warning');
                } else {
                    addStatus('‚ùå NO DRILLS IN LOCAL STORAGE!', 'error');
                }
                
            } catch (error) {
                addStatus(`‚ùå Error reading local storage: ${error.message}`, 'error');
            }
        };

        window.clearCache = function() {
            if (confirm('Are you sure you want to clear all local data?')) {
                localStorage.removeItem('hockey-drills');
                localStorage.removeItem('hockey-practice-plans');
                localStorage.removeItem('hockey-settings');
                localStorage.removeItem('hockey-device-id');
                
                addStatus('üóëÔ∏è All local data cleared!', 'warning');
                addStatus('üîÑ Reloading page in 2 seconds...', 'info');
                
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
            }
        };

        window.showAllData = function() {
            addStatus('üìä ALL LOCAL STORAGE DATA:', 'info');
            
            const allData = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && key.startsWith('hockey-')) {
                    try {
                        allData[key] = JSON.parse(localStorage.getItem(key));
                    } catch (e) {
                        allData[key] = localStorage.getItem(key);
                    }
                }
            }
            
            const dataDiv = document.createElement('div');
            dataDiv.className = 'data-display';
            dataDiv.textContent = JSON.stringify(allData, null, 2);
            document.getElementById('details').appendChild(dataDiv);
        };

        window.testAppConnection = async function() {
            addStatus('üåê Testing app connection...', 'info');
            
            try {
                const response = await fetch('https://hockey-practice-planner.vercel.app');
                if (response.ok) {
                    addStatus('‚úÖ App URL is accessible', 'success');
                    
                    const text = await response.text();
                    if (text.includes('Hockey Practice Planner')) {
                        addStatus('‚úÖ App is loading correctly', 'success');
                        
                        if (text.includes('Loading Your Data')) {
                            addStatus('‚ö†Ô∏è App is stuck on loading screen', 'warning');
                        } else {
                            addStatus('‚úÖ App appears to be working', 'success');
                        }
                    } else {
                        addStatus('‚ùå App content looks wrong', 'error');
                    }
                } else {
                    addStatus(`‚ùå App returned status: ${response.status}`, 'error');
                }
            } catch (error) {
                addStatus(`‚ùå Connection error: ${error.message}`, 'error');
            }
        };

        // Auto-run initial check
        setTimeout(() => {
            addStatus('üöÄ Starting automatic diagnostic...', 'info');
            checkLocalStorage();
            testAppConnection();
        }, 1000);
    </script>
</body>
</html>
